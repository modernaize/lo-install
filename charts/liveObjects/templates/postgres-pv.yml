{{- if .Values.persistence.enabled }}
  {{- if .Values.persistence.postgres.data.pv.enabled }}
---
apiVersion: v1
kind: PersistentVolume
metadata:
  name: {{ .Release.Namespace }}-{{ .Values.persistence.postgres.data.pv.metadata.name}}
  labels:
    app.kubernetes.io/managed-by: helm
    app.kubernetes.io/name: {{ .Chart.Name }}
    app.kubernetes.io/version: {{ .Chart.Version }}
    app.kubernetes.io/appVersion: {{ .Chart.AppVersion }}
    app.kubernetes.io/component: pv
    app.kubernetes.io/helm-application: {{ .Release.Name }}
    track: "stable"
spec:
  storageClassName: ""
  capacity:
    storage: 100G
  accessModes:
    - ReadWriteOnce
    {{- if eq .Values.persistence.persistensDisk "gcePersistentDisk"}}
  gcePersistentDisk:
    pdName: {{ .Release.Namespace }}-{{ .Values.persistence.postgres.data.pv.spec.gcePersistentDisk.pdName}}
    fsType: {{ .Values.persistence.postgres.data.pv.spec.gcePersistentDisk.fsType}}
    {{- end }}
    {{- if eq .Values.persistence.persistensDisk "awsElasticBlockStore"}}
  awsElasticBlockStore:
    volumeID: {{ .Values.persistence.postgres.data.pv.spec.awsElasticBlockStore.volumeID}}
    fsType: {{ .Values.persistence.postgres.data.pv.spec.awsElasticBlockStore.fsType}}
    {{- end }}
    {{- if eq .Values.persistence.persistensDisk "elasticFileSystem"}}
  elasticFileSystem:
    server: {{ .Values.persistence.postgres.data.pv.spec.elasticFileSystem.server}}
    path: {{ .Values.persistence.postgres.data.pv.spec.elasticFileSystem.path}}
    {{- end }}
    {{- if eq .Values.persistence.persistensDisk "azureDisk"}}
  azureDisk:
    diskName: {{ .Values.persistence.postgres.data.pv.spec.azureDisk.diskName}}
    diskURI: {{ .Values.persistence.postgres.data.pv.spec.azureDisk.diskURI}}
    {{- end }}
    {{- if eq .Values.persistence.persistensDisk "azureFileStorage"}}
  azureFileStorage:
    secretName: {{ .Values.persistence.postgres.data.pv.spec.azureFileStorage.secretName}}
    shareName: {{ .Values.persistence.postgres.data.pv.spec.azureFileStorage.shareName}}
    readOnly: {{ .Values.persistence.postgres.data.pv.spec.azureFileStorage.readOnly}}
    {{- end }}
  {{- end }}
{{- end }}